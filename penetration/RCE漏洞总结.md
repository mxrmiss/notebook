

**1\. 什么是远程代码执行漏洞**

远程命令/代码执行漏洞，简称RCE漏洞，可以让攻击者直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。RCE分为远程命令执行ping和远程代码执行evel。

**2\. 漏洞产生的根本原因**

服务器没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令。

**3\. 如何挖掘RCE漏洞**

黑盒测试：网站中有特殊功能，比如Ping、[数据库](https://cloud.tencent.com/solution/database?from=10680)备份等等。

白盒测试：查看命令执行函数是否做过滤。命令执行函数如下：

PHP代码执行函数：eval()、assert()、preg\_replace()、create\_function()、array\_map()、call\_user\_func()、call\_user\_func\_array()、array\_filter()、uasort()

PHP命令执行函数：system()、exec()、shell\_exec()、pcntl\_exec()、popen()、proc\_popen()、passthru()

**4\. 挖到这个漏洞能做什么**

*   远程命令、代码执行（单凭这一点能做的事情就不少，如下）
*   获取敏感数据、文件、服务器信息
*   写入恶意文件Getshell

**5\. 如何利用此漏洞**

在网上你会发现有很多关于RCE的文章基本都是白盒检测出来的，但是往往渗透测试过程中，我们都是黑盒测试的。但是黑盒挖掘RCE漏洞太难了，很少有特征点，要理解参数的意义才有可能黑盒测试到。留意下一章......

**6\. 漏洞造成的危害**

RCE漏洞造成的危害不言而喻，高危漏洞。能直接获取服务器的控制权（既然服务器都拿下了，为所欲为。）

**7\. 发现此漏洞，该怎么修复**

*   通用的修复方案，升级插件/框架/服务最新版。
*   如若必须使用危险函数，那么针对危险函数进行过滤。

**8\. 如何防范此漏洞**

*   在进入执行命令函数前进行严格的检测和过滤；
*   尽量不要使用命令执行函数，不能完全控制的危险函数最好不使用；
*   对于eval函数，一定要保证用户不能轻易接触eval的参数或者用正则严格判断输入的数据格式；
*   上云WAF当然最稳，哈哈哈。

**注：** 漏洞的影响范围和利用的前提条件要视情况而定，例如Struts2著名的RCE漏洞，直至现在2020年，以前很多一些旧的漏洞已经不复存在，我们只好理解其中的原理即可。

若感兴趣的可以去了解一下由深信服千里日安全实验室写的这篇文章。

传送：https://www.freebuf.com/vuls/168609.html
