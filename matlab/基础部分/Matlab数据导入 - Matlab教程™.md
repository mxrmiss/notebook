在MATLAB中导入数据意味着从外部文件加载数据。importdata函数允许加载不同格式的各种数据文件。它有以下五种形式 -

| 序号 | 函数 | 描述 |
| --- | --- | --- |
| 1 | `A = importdata(filename)` | 从文件_filename_中将数据加载到数组A中。 |
| 2 | `A = importdata('-pastespecial')` | 从系统剪贴板而不是从文件加载数据。 |
| 3 | `A = importdata(___, delimiterIn)` | 解析`delimiterIn`作为在`ASCII`文件，文件名或剪贴板数据中的列分隔符。可以使用`delimiterIn`与上述语法中的任何输入参数。 |
| 4 | `A = importdata(___, delimiterIn, headerlinesIn)` | 从ASCII文件，文件名或剪贴板加载数据，从行头标题`In + 1`开始读取数字数据。 |
| 5 | `[A, delimiterOut, headerlinesOut] = importdata(___)` | 返回在`delimiterOut`中检测到的输入ASCII文件的分隔符字符，并使用前面语法中的任何输入参数检测`headerlinesOut`中检测到的标题行数。 |

> 默认情况下，Octave不支持`importdata()`函数，因此必须搜索并安装此软件包，以使以下示例与`Octave`安装配合使用。

示例 - 1
------

下面加载并显示一个图像文件。 创建脚本文件并在其中键入以下代码：

```
filename = 'mydog.jpg';
A = importdata(filename);
image(A); 
```

执行上面示例代码，得到以下结果 -

![](https://mxrblog.cn/matlab/288101036_81362.png)

运行文件时，MATLAB显示图像文件。但是，必须将其存储在当前工作目录(_F:\\worksp\\matlab_)中。

示例 - 2
------

在这个例子中，导入一个文本文件并使用指定分隔符和列标题。下面用列标题创建一个空格分隔的ASCII文件，名称为_weeklydata.txt_。

文本文件_weeklydata.txt_的内容如下 -

```
周一  周二  周三  周四  周五  周六  周日
95.01   76.21   61.54    40.57       55.79    70.28   81.53
73.11   45.65   79.19    93.55       75.29    69.87   74.68
60.68   41.85   92.18    91.69       81.32    90.38   74.51
48.60   82.14   73.82    41.03       0.99     67.22   93.18
89.13   44.47   57.63    89.36       13.89    19.88   46.60 
```

创建脚本文件并在其中键入以下代码 -

```
Trial>> filename = 'weeklydata.txt';
delimiterIn = ' ';
headerlinesIn = 1;
A = importdata(filename,delimiterIn,headerlinesIn);
% View data
for k = [1:7]
   disp(A.colheaders{1, k})
   disp(A.data(:, k))
   disp(' ')
end
周一
   95.0100
   73.1100
   60.6800
   48.6000
   89.1300


周二
   76.2100
   45.6500
   41.8500
   82.1400
   44.4700


周三
   61.5400
   79.1900
   92.1800
   73.8200
   57.6300


周四
   40.5700
   93.5500
   91.6900
   41.0300
   89.3600


周五
   55.7900
   75.2900
   81.3200
    0.9900
   13.8900


周六
   70.2800
   69.8700
   90.3800
   67.2200
   19.8800


周日
   81.5300
   74.6800
   74.5100
   93.1800
   46.6000 
```

示例 - 3
------

在这个例子中，从剪贴板中导入数据。

将以下行复制到剪贴板 -

```
Matlab is simple，I like it. 
```

创建脚本文件并键入以下代码 -

```
A = importdata('-pastespecial') 
```

执行上面示例代码，得到以下结果 -

```
Trial>> A = importdata('-pastespecial')

A =

  1×1 cell 数组

    {'Matlab is simple，I like it.'} 
```

低级文件I/O
-------

`importdata`函数是一个高级函数。 MATLAB中的低级文件I/O函数允许对文件读取或写入数据控制。但是，这些函数需要更多关于文件的详细信息才能有效地工作。

MATLAB为字节或字符级别的读写操作提供以下函数 -

| 函数 | 描述 |
| --- | --- |
| `fclose` | 关闭一个或所有打开的文件 |
| `feof` | 测试文件结尾 |
| `ferror` | 有关文件I/O错误的信息 |
| `fgetl` | 从文件读取行，删除换行符 |
| `fgets` | 从文件读取行，保留换行符 |
| `fopen` | 打开文件，或获取有关打开文件的信息 |
| `fprintf` | 将数据写入文本文件 |
| `fread` | 从二进制文件读取数据 |
| `frewind` | 将文件位置指示器移动到打开文件的开头 |
| `fscanf` | 从文本文件读取数据 |
| `fseek` | 移动到文件中的指定位置 |
| `ftell` | 在打开文件中的位置 |
| `fwrite` | 将数据写入二进制文件 |

导入具有低级别I/O的文本数据文件
-----------------

MATLAB提供以下函数，用于低级导入文本数据文件 -

*   `fscanf`函数读取文本或ASCII文件中的格式化数据。
*   `fgetl`和`fgets`函数一次读取文件的一行，换行符分隔每行。
*   读取函数以字节或位级别读取数据流。

示例
--

假设有一个文本数据文件`myfile.txt`保存在工作目录中。此文件存放三个月的降雨资料： 2012年6月，7月和8月降雨量。

`myfile.txt`中的数据在五个地方包含重复的时间，月份和降雨量测量。标题数据存储月数`M`; 所以有`M`个集合测量值。

文件内容看起来如下 -

```
Rainfall Data
Months: June, July, August

M=3
12:00:00
June-2012
17.21  28.52  39.78  16.55 23.67
19.15  0.35   17.57  NaN   12.01
17.92  28.49  17.40  17.06 11.09
9.59   9.33   NaN    0.31  0.23 
10.46  13.17  NaN    14.89 19.33
20.97  19.50  17.65  14.45 14.00
18.23  10.34  17.95  16.46 19.34
09:10:02
July-2012
12.76  16.94  14.38  11.86 16.89
20.46  23.17  NaN    24.89 19.33
30.97  49.50  47.65  24.45 34.00
18.23  30.34  27.95  16.46 19.34
30.46  33.17  NaN    34.89  29.33
30.97  49.50  47.65  24.45 34.00
28.67  30.34  27.95  36.46 29.34
15:03:40
August-2012
17.09  16.55  19.59  17.25 19.22
17.54  11.45  13.48  22.55 24.01
NaN    21.19  25.85  25.05 27.21
26.79  24.98  12.23  16.99 18.67
17.54  11.45  13.48  22.55 24.01
NaN    21.19  25.85  25.05 27.21
26.79  24.98  12.23  16.99 18.67 
```

从此文件导入数据并显示此数据。请按照以下步骤 -

*   使用`fopen`函数打开文件并获取文件标识符。
*   使用格式说明符描述文件中的数据，例如字符串的`%s`，整数`%d`或浮点数`%f`。
*   要跳过文件中的文字，请将其包含在格式说明中。要跳过数据字段，请在说明符中使用星号(`*`)。例如，要读取头文件并返回`M`的单个值，可以书写为：```
    M = fscanf(fid, '%*s %*s\n%*s %*s %*s %*s\nM=%d\n\n', 1); 
    
    ```
    
*   默认情况下，`fscanf`会根据格式描述读取数据，直到找不到数据的匹配，或到达文件的末尾。这里使用`for`循环读取`3`组数据，每次读取`7`行和`5`列。
*   将在工作空间中创建一个名为`mydata`的结构来存储从文件读取的数据。这个结构有三个字段 - 时间，月份和雨天数组。

创建脚本文件(_readraindata.m_)并在其中键入以下代码 -

```
filename = 'myfile.txt';
rows = 7;
cols = 5;

fid = fopen(filename);

M = fscanf(fid, '%*s %*s\n%*s %*s %*s %*s\nM=%d\n\n', 1);

for n = 1:M
   mydata(n).time = fscanf(fid, '%s', 1);
   mydata(n).month = fscanf(fid, '%s', 1);

   
   
   mydata(n).raindata  = ...
      fscanf(fid, '%f', [rows, cols]);
end
for n = 1:M
   disp(mydata(n).time), disp(mydata(n).month)
   disp(mydata(n).raindata)
end

fclose(fid); 
```

执行上面示例代码，得到以下结果 -

```
Trial>> readraindata
12:00:00
June-2012
   17.2100   17.5700   11.0900   13.1700   14.4500
   28.5200       NaN    9.5900       NaN   14.0000
   39.7800   12.0100    9.3300   14.8900   18.2300
   16.5500   17.9200       NaN   19.3300   10.3400
   23.6700   28.4900    0.3100   20.9700   17.9500
   19.1500   17.4000    0.2300   19.5000   16.4600
    0.3500   17.0600   10.4600   17.6500   19.3400

09:10:02
July-2012
   12.7600       NaN   34.0000   33.1700   24.4500
   16.9400   24.8900   18.2300       NaN   34.0000
   14.3800   19.3300   30.3400   34.8900   28.6700
   11.8600   30.9700   27.9500   29.3300   30.3400
   16.8900   49.5000   16.4600   30.9700   27.9500
   20.4600   47.6500   19.3400   49.5000   36.4600
   23.1700   24.4500   30.4600   47.6500   29.3400

15:03:40
August-2012
   17.0900   13.4800   27.2100   11.4500   25.0500
   16.5500   22.5500   26.7900   13.4800   27.2100
   19.5900   24.0100   24.9800   22.5500   26.7900
   17.2500       NaN   12.2300   24.0100   24.9800
   19.2200   21.1900   16.9900       NaN   12.2300
   17.5400   25.8500   18.6700   21.1900   16.9900
   11.4500   25.0500   17.5400   25.8500   18.6700 
```

